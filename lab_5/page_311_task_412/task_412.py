import numpy as np
from scipy.optimize import linprog
import openpyxl
from openpyxl.styles import Font

# Коэффициенты прироста выпуска продукции для каждого предприятия
c = [-14, -18, -28, -39]

# Матрица коэффициентов ограничений
A = [
    [1, 1, 1, 1],  # Суммарные капиталовложения
]

# Вектор правых частей ограничений
b = [100]  # Суммарные капиталовложения

# Границы для переменных (капиталовложения должны быть неотрицательными)
x_bounds = (0, None)
bounds = [x_bounds, x_bounds, x_bounds, x_bounds]

# Решение задачи линейного программирования
result = linprog(c, A_ub=A, b_ub=b, bounds=bounds, method='highs')

# Результаты
x = result.x
max_profit = -result.fun

# Отчет
report = f"""
Отчет по задаче 4.12

Оптимальный план распределения капиталовложений:
x1 = {x[0]:.2f} тыс. руб.
x2 = {x[1]:.2f} тыс. руб.
x3 = {x[2]:.2f} тыс. руб.
x4 = {x[3]:.2f} тыс. руб.

Максимальный прирост выпуска продукции: {max_profit:.2f} тыс. руб.

Формулы:
1. Целевая функция: F = 14*x1 + 18*x2 + 28*x3 + 39*x4
2. Ограничение: x1 + x2 + x3 + x4 = 100
3. Ограничения на переменные: x1 >= 0, x2 >= 0, x3 >= 0, x4 >= 0
"""

print(report)

# Создание Excel-файла и запись результатов
wb = openpyxl.Workbook()
ws = wb.active
ws.title = "Отчет"

# Заголовки
ws.append(["Предприятие", "Капиталовложения (тыс. руб.)"])

# Данные
for i in range(4):
    ws.append([f"Предприятие {i+1}", x[i]])

# Добавление формул и результатов
ws.append(["", ""])
ws.append(["Максимальный прирост выпуска продукции", max_profit])
ws.append(["Формулы:", ""])
ws.append(["Целевая функция", "F = 14*x1 + 18*x2 + 28*x3 + 39*x4"])
ws.append(["Ограничение", "x1 + x2 + x3 + x4 = 100"])
ws.append(["Ограничения на переменные", "x1 >= 0, x2 >= 0, x3 >= 0, x4 >= 0"])

# Выделение заголовков жирным шрифтом
for cell in ws[1]:
    cell.font = Font(bold=True)

# Сохранение файла
wb.save("report.xlsx")

print("Отчет сохранен в файл report.xlsx")
